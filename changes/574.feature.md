Add shared_by value when query accessible vfolders method and refactor the method for better flow control based on user role.
